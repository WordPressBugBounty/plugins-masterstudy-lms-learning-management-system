"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}!function(e){e(document).ready((function(){new Vue({el:"#stm_lms_my_bundle",data:function(){return{courses:stm_lms_my_bundle_courses.list.posts,bundle_courses:[],bundle_name:"",bundle_description:"",bundle_price:"",bundle_image_id:"",bundle_limit:stm_lms_my_bundle_courses.bundle_limit,bundle_upload_image:"",select_course_search:"",select_course_open:!1,status:"",message:"",loading:!1}},mounted:function(){var t=this,s=stm_lms_my_bundle.data;void 0!==s&&(void 0!==s.post_title&&t.$set(t,"bundle_name",s.post_title),void 0!==s.post_content&&t.$set(t,"bundle_description",s.post_content),void 0!==s.bundle_price&&t.$set(t,"bundle_price",s.bundle_price),void 0!==s.bundle_courses&&t.$set(t,"bundle_courses",s.bundle_courses),void 0!==s.bundle_image_id&&t.$set(t,"bundle_image_id",s.bundle_image_id)),Vue.nextTick((function(){if("undefined"!=typeof tinyMCE){var s=tinyMCE.get(stm_lms_my_bundle_courses.editor_id);if(null!==s)t.$set(t,"bundle_description",s.getContent()),s.on("keyup",(function(e){t.$set(t,"bundle_description",s.getContent())}));else{var n=e("#"+stm_lms_my_bundle_courses.editor_id);t.$set(t,"bundle_description",n.val()),n.on("change keyup paste",(function(){t.$set(t,"bundle_description",n.val())}))}}}))},methods:{alreadyAdded:function(e){var t=!1;return this.bundle_courses.forEach((function(s){s.id===e.id&&(t=!0)})),t},addCourseInBundle:function(e){if(parseFloat(this.bundle_limit)<=this.bundle_courses.length)return alert("You reached maximum courses in bundle."),!1;this.bundle_courses.push(e)},saveBundle:function(){var e=this,t=e.bundle_name,s=e.bundleCoursesIds,n=e.bundle_price,u=e.bundle_description;e.$set(e,"status",""),e.$set(e,"message","");var i=new FormData;i.append("id",stm_lms_my_bundle_courses.bundle_id),i.append("name",t),i.append("courses",s),i.append("price",n),i.append("description",u),i.append("file",e.bundle_upload_image),e.loading=!0,e.$http.post(stm_lms_ajaxurl+"?action=stm_lms_save_bundle",i).then((function(t){t=t.body,e.loading=!1;var s="";if("object"===_typeof(t.message))for(var n in t.message)s+=t.message[n]+"<br>";else s=t.message;e.$set(e,"status",t.status),e.$set(e,"message",s),void 0!==t.url&&(window.location.href=t.url)}))},previewFiles:function(){void 0!==this.$refs.bundleImage.files[0]&&this.$set(this,"bundle_upload_image",this.$refs.bundleImage.files[0])}},computed:{filteredList:function(){var e=this;return this.courses.filter((function(t){return t.title.toLowerCase().includes(e.select_course_search.toLowerCase())}))},totalPrice:function(){var e=0;return this.bundle_courses.forEach((function(t){""!==t.simple_price&&(e+=parseFloat(t.simple_price))})),stm_lms_price_format(Math.round(100*e)/100)},bundleCoursesIds:function(){var e=[];return this.bundle_courses.forEach((function(t){e.push(t.id)})),e}}})}))}(jQuery);