"use strict";stm_lms_components.course={template:"#stm-lms-dashboard-course",props:["id"],components:{add_user:stm_lms_components.add_user,user_data_transfer:stm_lms_components.user_data_transfer,back:stm_lms_components.back},data:function(){return{id:0,origin_title:"",title:"",loading:!0,students:[],pages:0,limit:50,search:"",sort:"",sortDirection:"DESC",page:1,studentPublic:course_data.student_public}},mounted:function(){this.id=this.$route.params.id,this.getStudents()},computed:{studentsList:function(){var t=this,e=t.students.filter((function(e){return-1!==e.student.login.toLowerCase().indexOf(t.search.toLowerCase())}));""!==t.sort&&(e=e.sort(t.compare));var s=t.limit;if(s<1&&(s=50),t.pages=Math.ceil(e.length/s),1===t.page)return e.slice(0,s);var r=(t.page-1)*s,o=(t.page-1)*s+s;return e.slice(r,o)}},methods:{compare:function(t,e){var s="DESC"===this.sortDirection?-1:1,r=t.student.login,o=e.student.login;return"progress"===this.sort&&(r=t.progress_percent,o=e.progress_percent),"time"===this.sort&&(r=parseInt(t.start_time),o=parseInt(e.start_time)),"name"===this.sort&&(r=r.toLowerCase(),o=o.toLowerCase()),"email"===this.sort&&(r=t.student.email.toLowerCase(),o=e.student.email.toLowerCase()),r<o?-s:r>o?s:0},getStudents:function(){var t=this;t.loading=!0;var e=stm_lms_ajaxurl+"?action=stm_lms_dashboard_get_course_students";e+="&course_id="+t.id+"&nonce="+stm_lms_nonces.stm_lms_dashboard_get_course_students,t.$http.get(e).then((function(e){e=e.body,t.loading=!1,t.$set(t,"title",e.title),t.$set(t,"origin_title",e.origin_title),t.$set(t,"students",e.students)}))},toUser:function(t,e){this.$router.push({path:"/course/"+t+"/"+e})},deleteUserCourse:function(t,e,s){if(!confirm("Are you sure you want to delete the student? Deleting the student will also remove their course progress and all associated data."))return!1;var r=this;r.$set(e,"loading",!0);var o=stm_lms_ajaxurl+"?action=stm_lms_dashboard_delete_user_from_course";o+="&course_id="+t+"&user_id="+e.user_id+"&nonce="+stm_lms_nonces.stm_lms_dashboard_delete_user_from_course,void 0===e.user_id&&(o+="&user_email="+e.student.email),r.$http.get(o).then((function(){r.$set(e,"loading",!1),r.getStudents()}))},studentAdded:function(){this.getStudents()},sortBy:function(t){var e=this;t===e.sort&&(e.sortDirection="DESC"===e.sortDirection?"ASC":"DESC"),e.sort=t}}};