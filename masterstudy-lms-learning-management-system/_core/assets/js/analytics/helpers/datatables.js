"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function ownKeys(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(a),!0).forEach((function(t){_defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function _defineProperty(e,t,a){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=_typeof(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var isDomReady=!1;function createDataTable(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s={data:[],retrieve:!0,processing:!0,serverSide:!0,columns:t,layout:{topStart:null,topEnd:null,bottomStart:{paging:{numbers:5}},bottomEnd:{pageLength:{menu:[10,25,50]}}},language:{lengthMenu:"_MENU_"+table_data.per_page_placeholder,emptyTable:table_data.not_available,zeroRecords:table_data.not_found}},n=Object.assign({},s,a);return new DataTable(e,n)}function updateDataTable(e,t,a,s,n,o){var r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],i=arguments.length>8&&void 0!==arguments[8]&&arguments[8],l=arguments.length>9&&void 0!==arguments[9]&&arguments[9],d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:[],c=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"",u=arguments.length>12&&void 0!==arguments[12]?arguments[12]:"";if(isDomReady){if(!e||arguments.length>7&&void 0!==arguments[7]&&arguments[7]){a.forEach((function(e){showLoaders(e)})),e&&(e.clear().destroy(),e=null,jQuery(t).empty());var y={order:[[0,"desc"]],ajax:{url:api.getRouteUrl(s),type:"POST",dataType:"json",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",api.getRouteNonce())},data:function(e){e.date_from=getDateFrom(),e.date_to=getDateTo(),e.search.value=c,"#masterstudy-datatable-lessons"===t&&(e.type=document.getElementById("masterstudy-analytics-course-page-types").value)},dataSrc:o,complete:function(){a.forEach((function(e){hideLoaders(e)}))}},columnDefs:r};u&&(y.order=[[u,"desc"]]),l&&(y.ajax.data=function(e){e.date_from=getDateFrom(),e.date_to=getDateTo(),e.search.value=c,document.getElementById("masterstudy-analytics-course-page-orders")&&(e.sort=document.getElementById("masterstudy-analytics-course-page-orders").value)},d.forEach((function(e){n.push({title:'<img src="'+table_data.img_route+"/assets/icons/lessons/"+e.lesson_type+'.svg" class="masterstudy-datatables-lesson-icon"></img>'+e.lesson_name,data:e.lesson_id,orderable:!1,tooltip:e.lesson_name,render:function(e,t,a,s){return"-"===e?'<div class="masterstudy-datatables-lesson-type masterstudy-datatables-lesson-type_progress">\n                                <div class="masterstudy-datatables-lesson-tooltip">'+table_data.progress_lesson+"</div></div>":"0"===e?'<div class="masterstudy-datatables-lesson-type">\n                                <div class="masterstudy-datatables-lesson-tooltip">'+table_data.not_started_lesson+"</div></div>":"1"===e?'<div class="masterstudy-datatables-lesson-type masterstudy-datatables-lesson-type_complete">\n                                <div class="masterstudy-datatables-lesson-tooltip">'+table_data.completed_lesson+"</div></div>":"-1"===e?'<div class="masterstudy-datatables-lesson-type masterstudy-datatables-lesson-type_failed">\n                                <div class="masterstudy-datatables-lesson-tooltip">'+table_data.failed_lesson+"</div></div>":void 0}})})),n.push({title:"",data:"last",orderable:!1}),y=_objectSpread(_objectSpread({},y),{},{columnDefs:[{targets:0,width:"30px",orderable:!1},{targets:1,width:"200px",orderable:!0}],headerCallback:function(e){jQuery(e).find(".masterstudy-datatables-skew").length||jQuery(e).find("th.dt-orderable-none").not('[data-dt-column="0"]').wrapInner('<div class="masterstudy-datatables-skew"><div class="masterstudy-datatables-skew__container"></div></div>')},initComplete:function(){a.forEach((function(e){hideLoaders(e)})),this.api().columns().header().to$().each((function(){jQuery(this).find(".masterstudy-datatables-skew").append('<div class="masterstudy-datatables-skew__tooltip"><span>'+jQuery(this).text()+"</span></div>")})),jQuery(".masterstudy-datatables-skew").mouseover((function(e){jQuery(this).parent().find(".masterstudy-datatables-skew__tooltip").addClass("masterstudy-datatables-skew__tooltip_active")})).mouseout((function(){jQuery(this).parent().find(".masterstudy-datatables-skew__tooltip").removeClass("masterstudy-datatables-skew__tooltip_active")}))},columns:n})),observeTableChanges(e=createDataTable(t,n,y),i)}return e}}function tablePaginationVisibility(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.table().container(),s=a.querySelector(".dt-layout-cell.dt-start"),n=a.querySelector(".dt-layout-cell.dt-end");0===e.data().count()||t?(s&&(s.style.display="none"),n&&(n.style.display="none")):(s&&(s.style.display=""),n&&(n.style.display=""))}function observeTableChanges(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.table().container();new MutationObserver((function(){tablePaginationVisibility(e,t)})).observe(a,{childList:!0,subtree:!0}),new IntersectionObserver((function(t){t.forEach((function(t){t.isIntersecting&&e.columns.adjust()}))}),{threshold:.1}).observe(a)}function searchFieldIntent(e){var t=new CustomEvent("intentTableSearch",{detail:{searchValue:e.value.trim(),searchTarget:e}});document.dispatchEvent(t)}document.addEventListener("DOMContentLoaded",(function(){isDomReady=!0,document.querySelectorAll('input[id*="-search"]').length&&document.querySelectorAll('input[id*="-search"]').forEach((function(e){e.addEventListener("keydown",(function(e){var t=this;window.search_field_intent_timeout&&clearTimeout(window.search_field_intent_timeout),13===e.keyCode?searchFieldIntent(t):window.search_field_intent_timeout=setTimeout((function(){searchFieldIntent(t)}),1e3)}))})),document.addEventListener("click",(function(e){if(e.target.matches('div[class*="__search-dropdown-item"]')){var t=e.target,a=t.textContent.trim(),s=t.parentNode.parentNode.querySelector("input");s&&(s.value=a),s.classList.contains("grades-search")&&(s.dataset.id=t.dataset.id),searchFieldIntent(s)}})),document.querySelectorAll('span[class*="__search-icon"]')&&document.querySelectorAll('span[class*="__search-icon"]').forEach((function(e){e.addEventListener("click",(function(e){""!==this.parentNode.querySelector("input").value&&searchFieldIntent(this.parentNode.querySelector("input"))}))}))}));