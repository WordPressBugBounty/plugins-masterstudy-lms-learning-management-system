"use strict";new Vue({el:"#stm_lms_user_manage",data:{users:[],loading:!0,direction:"DESC",currentPage:1,total:1,aiToggle:!1,historyModal:{status:!1,history:[]}},mounted:function(){this.getUsers(),this.$refs.aiToggle.classList.toggle("active",this.aiToggle)},computed:{computedUsers:function(){return"ASC"===this.direction?this.users.slice().sort((function(s,t){return s.submission_time-t.submission_time})):this.users.slice().sort((function(s,t){return t.submission_time-s.submission_time}))}},methods:{getUsers:function(){var s=this,t=stm_lms_ajaxurl+"?action=stm_lms_get_users_submissions&nonce="+stm_lms_nonces.stm_lms_get_users_submissions+"&page="+s.currentPage;s.loading=!0,this.$http.get(t).then((function(t){var e=t.body;s.loading=!1,s.users=e.users,s.total=Math.ceil(parseInt(e.total)/20),s.aiToggle=e.ai_enabled_for_all,this.$refs.aiToggle.classList.toggle("active",this.aiToggle)}))},updateUserStatus:function(s,t,e){var i=this,n=stm_lms_ajaxurl+"?action=stm_lms_update_user_status&nonce="+stm_lms_nonces.stm_lms_update_user_status+"&status="+e+"&message="+i.computedUsers[t].message+"&user_id="+s;i.loading=!0,i.$http.get(n).then((function(s){var n=s.body;i.$set(i.computedUsers[t],"submission_history",n),i.$set(i.computedUsers[t],"status",e),i.loading=!1}))},showHistory:function(s){var t=this;t.$set(t.historyModal,"status",!0),t.$set(t.historyModal,"history",t.computedUsers[s].submission_history)},banUser:function(s,t){var e=this,i=stm_lms_ajaxurl+"?action=stm_lms_ban_user&nonce="+stm_lms_nonces.stm_lms_ban_user+"&user_id="+s+"&banned="+t;e.loading=!0,e.$http.get(i).then((function(s){e.loading=!1}))},toggleUserAI:function(s,t){var e=this,i=stm_lms_ajaxurl+"?action=stm_lms_toggle_user_ai_access&nonce="+stm_lms_nonces.stm_lms_ban_user+"&user_id="+s+"&ai_enabled="+t;e.loading=!0,e.$http.get(i).then((function(s){e.loading=!1}))},toggleAI:function(){var s=this,t=stm_lms_ajaxurl+"?action=stm_lms_toggle_users_ai_access&nonce="+stm_lms_nonces.stm_lms_ban_user+"&ai_enabled="+s.aiToggle;s.loading=!0,s.$http.get(t).then((function(t){s.loading=!1,s.aiToggle=!s.aiToggle,s.getUsers()}))},changePage:function(s){this.currentPage=s,this.getUsers()}}});