"use strict";!function(s){s(document).ready((function(){var e=s(".masterstudy-message-modal");setTimeout((function(){e.removeAttr("style")}),1e3),e.on("click",(function(e){e.target===this&&(s(this).removeClass("masterstudy-message-modal_open"),s("body").removeClass("masterstudy-message-modal-body-hidden"))})),s(".masterstudy-instructor-public__actions .masterstudy-button, .masterstudy-student-public__actions .masterstudy-button").on("click",(function(a){a.preventDefault(),message_modal_data.logged_in&&(e.addClass("masterstudy-message-modal_open"),s("body").addClass("masterstudy-message-modal-body-hidden"))})),s('.masterstudy-message-modal__close, [data-id="masterstudy-message-modal-close-button"]').click((function(e){e.preventDefault(),s(this).closest(".masterstudy-message-modal").removeClass("masterstudy-message-modal_open"),s("body").removeClass("masterstudy-message-modal-body-hidden")})),s("#masterstudy-message-modal-text").on("input",(function(){s(".masterstudy-message-modal__error").removeClass("masterstudy-message-modal__error_show")})),s('[data-id="masterstudy-message-modal-confirm"]').click((function(e){e.preventDefault(),s(".masterstudy-message-modal__error").removeClass("masterstudy-message-modal__error_show");var a=s(this),t=s("#masterstudy-message-modal-text").val();if(t.length>0){a.addClass("masterstudy-button_loading");var m={to:message_modal_data.user_id,message:t},o=stm_lms_ajaxurl+"?action=stm_lms_send_message&nonce="+stm_lms_nonces.stm_lms_send_message;fetch(o,{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(m)}).then((function(s){if(!s.ok)throw new Error("There was a problem with the fetch operation");return s.json()})).then((function(e){a.removeClass("masterstudy-button_loading"),"success"===e.status&&(s(".masterstudy-message-modal__form").addClass("masterstudy-message-modal__form_hide"),s(".masterstudy-message-modal__user").addClass("masterstudy-message-modal__user-hide"),s(".masterstudy-message-modal__actions").addClass("masterstudy-message-modal__actions_hide"),s(".masterstudy-message-modal__success").addClass("masterstudy-message-modal__success_show"))})).catch((function(s){console.error("There was a problem with the fetch operation:",s)}))}else s(".masterstudy-message-modal__error").addClass("masterstudy-message-modal__error_show")}))}))}(jQuery);