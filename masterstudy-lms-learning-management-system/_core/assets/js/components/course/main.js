"use strict";!function(e){function s(s){var t=s?e(this).parent().next():e(this).parent().parent().next(),i=s?"masterstudy-curriculum-list__wrapper_opened":"masterstudy-curriculum-list__container-wrapper_opened";if(t.is(":visible"))t.animate({height:0},100,(function(){setTimeout((function(){t.css("display","none"),t.css("height","")}),300)})),e(this).parent().parent().removeClass(i);else{t.css("display","block");var a=t.height("auto").height();t.height(0).animate({height:a},100,(function(){setTimeout((function(){t.css("height","")}),300)})),e(this).parent().parent().addClass(i)}}e(document).ready((function(){if("undefined"!=typeof expired_data&&expired_data.load_scripts){var t="stm_lms_expired_course_".concat(expired_data.id),i=e.cookie(t);e(".masterstudy-single-course-expired-popup").removeAttr("style"),setTimeout((function(){"closed"!==i&&(e("body").addClass("masterstudy-expired-popup"),e(".masterstudy-single-course-expired-popup").addClass("masterstudy-single-course-expired-popup_active"))}),200),e(".masterstudy-single-course-expired-popup").find(".masterstudy-button").on("click",(function(){e("body").removeClass("masterstudy-expired-popup"),e(".masterstudy-single-course-expired-popup").removeClass("masterstudy-single-course-expired-popup_active");var s=new Date;e.cookie(t,"closed",{path:"/",expires:s.getTime()+864e5})})),e(".masterstudy-single-course-expired-popup").on("click",(function(s){if(s.target===this){e(this).removeClass("masterstudy-single-course-expired-popup_active"),e("body").removeClass("masterstudy-expired-popup");var i=new Date;e.cookie(t,"closed",{path:"/",expires:i.getTime()+864e5})}}))}if(e(".masterstudy-single-course-reviews").each((function(s){var t=0,i=!0,a="",r="",n="grid"===reviews_data.style?9:5,o={},u=e(this),c=u.data("course-id"),d=u.find("[data-id='masterstudy-single-course-reviews-more']"),l=u.find(".masterstudy-single-course-reviews__list-wrapper"),m=u.find(".masterstudy-single-course-reviews__add-button"),_=u.find(".masterstudy-single-course-reviews__form-close"),y=u.find("[data-id='masterstudy-single-course-reviews-submit']"),g=u.find(".masterstudy-single-course-reviews__form-message"),v=u.find(".masterstudy-single-course-reviews__form-rating .masterstudy-single-course-reviews__star");function p(){var s="".concat(stm_lms_ajaxurl,"?action=stm_lms_get_reviews&nonce=").concat(stm_lms_nonces.stm_lms_get_reviews,"&offset=").concat(t,"&post_id=").concat(c,"&pp=").concat(n),a="";d.addClass("masterstudy-button_loading"),e.get(s,(function(e){e.posts.length>0&&(e.posts.forEach((function(e){a+=function(e){for(var s="",t=1;t<=5;t++)s+='<span class="masterstudy-single-course-reviews__star'.concat(t<=e.mark?" masterstudy-single-course-reviews__star_filled":"",'"></span>');return'\n                    <div class="masterstudy-single-course-reviews__item">\n                        <div class="masterstudy-single-course-reviews__item-header">\n                            <div class="masterstudy-single-course-reviews__item-mark">'.concat(s,"</div>\n                            ").concat("pending"===e.status?'<div class="masterstudy-single-course-reviews__item-status">'.concat(reviews_data.status,"</div>"):"",'\n                        </div>\n                        <div class="masterstudy-single-course-reviews__item-content">').concat(e.content,'</div>\n                        <div class="masterstudy-single-course-reviews__item-row">\n                            <a class="masterstudy-single-course-reviews__item-user" ').concat(reviews_data.student_public_profile?'href="'.concat(e.user_url,'"'):"",'>\n                                <span class="masterstudy-single-course-reviews__item-author">').concat(reviews_data.author_label,'</span>\n                                <span class="masterstudy-single-course-reviews__item-author-name">').concat(e.user,'</span>\n                            </a>\n                            <div class="masterstudy-single-course-reviews__item-date">').concat(e.time,"</div>\n                        </div>\n                    </div>")}(e)})),l.html(l.html()+a),t++,i=e.total),d.removeClass("masterstudy-button_loading"),i?d.parent().hide():d.parent().show()}))}"undefined"!=typeof reviews_data&&(p(),"undefined"!=typeof tinyMCE&&function(e){var s=reviews_data.editor_id;function t(){o[e]=tinyMCE.get(s),o[e]&&o[e].initialized?o[e].theme.resizeTo(null,200):setTimeout(t,500)}t()}(s),d.click((function(e){e.preventDefault(),p()})),m.click((function(e){e.preventDefault(),u.find(".masterstudy-single-course-reviews__form").addClass("masterstudy-single-course-reviews__form_active")})),_.click((function(s){s.preventDefault(),g.removeClass("masterstudy-single-course-reviews__form-message_active").html(""),u.find(".masterstudy-single-course-reviews__form").removeClass("masterstudy-single-course-reviews__form_active"),v.removeClass("masterstudy-single-course-reviews__star_clicked"),editor&&(editor.setContent(""),e(".masterstudy-wp-editor__word-count").html(""))})),y.click((function(t){t.preventDefault(),function(s,t){var i=stm_lms_ajaxurl+"?action=stm_lms_add_review&nonce="+stm_lms_nonces.stm_lms_add_review,n=o[t]||null;n&&(a=n.getContent());s.addClass("masterstudy-button_loading"),e.post(i,{post_id:c,mark:r,review:a},(function(t){"success"===t.status?(g.html(t.message),g.addClass("masterstudy-single-course-reviews__form-message_success masterstudy-single-course-reviews__form-message_active"),setTimeout((function(){u.find(".masterstudy-single-course-reviews__form").removeClass("masterstudy-single-course-reviews__form_active"),n&&(n.setContent(""),e(".masterstudy-wp-editor__word-count").html(""))}),1500)):(g.html(t.message),g.addClass("masterstudy-single-course-reviews__form-message_active")),s.removeClass("masterstudy-button_loading")}))}(y,s)})),v.click((function(){e(this).addClass("masterstudy-single-course-reviews__star_clicked"),e(this).siblings().removeClass("masterstudy-single-course-reviews__star_clicked"),e(this).prevAll().addBack().addClass("masterstudy-single-course-reviews__star_clicked"),r=u.find(".masterstudy-single-course-reviews__star_clicked").length})))})),e(".masterstudy-curriculum-list__toggler").click((function(e){e.preventDefault(),s.call(this,!0)})),e(".masterstudy-curriculum-list__excerpt-toggler").click((function(e){e.preventDefault(),s.call(this,!1)})),e(".masterstudy-curriculum-list__link_disabled").click((function(e){e.preventDefault()})),e(".masterstudy-hint").hover((function(){e(this).closest(".masterstudy-curriculum-list__materials").css("overflow","visible")}),(function(){e(this).closest(".masterstudy-curriculum-list__materials").css("overflow","hidden")})),e(".masterstudy-single-course-faq__item").click((function(){var s=e(this).find(".masterstudy-single-course-faq__answer"),t="masterstudy-single-course-faq__container-wrapper_opened";if(s.is(":visible"))s.animate({height:0},100,(function(){setTimeout((function(){s.css("display","none"),s.css("height","")}),300)})),e(this).find(".masterstudy-single-course-faq__container-wrapper").removeClass(t);else{s.css("display","block");var i=s.height("auto").height();s.height(0).animate({height:i},100,(function(){setTimeout((function(){s.css("height","")}),300)})),e(this).find(".masterstudy-single-course-faq__container-wrapper").addClass(t)}})),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&e(".masterstudy-single-course-materials__link").remove(),e(".masterstudy-single-course-materials__link").click((function(){e(".masterstudy-single-course-materials").find(".masterstudy-file-attachment__link").each((function(){var e=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});this.dispatchEvent(e)}))})),"undefined"!=typeof MasterstudyAudioPlayer&&MasterstudyAudioPlayer.init({selector:".masterstudy-audio-player",showDeleteButton:!1}),e(".masterstudy-single-course-tabs__item").click((function(){var s=e(this).data("id");e(this).siblings().removeClass("masterstudy-single-course-tabs__item_active"),e(this).addClass("masterstudy-single-course-tabs__item_active"),e(this).parent().next().find(".masterstudy-single-course-tabs__container").removeClass("masterstudy-single-course-tabs__container_active").filter((function(){return e(this).data("id")===s})).addClass("masterstudy-single-course-tabs__container_active")})),e(".masterstudy-single-course-tabs_style-sidebar").length&&!window.matchMedia("(max-width: 1023.98px)").matches){var a=!0;e(".masterstudy-single-course-tabs_style-sidebar").find(".masterstudy-single-course-tabs__item").click((function(){e("html, body").stop(),a=!1;var s=e(this).data("id");e(this).siblings().removeClass("masterstudy-single-course-tabs__item_active"),e(this).addClass("masterstudy-single-course-tabs__item_active");var t=e("body").find(".masterstudy-single-course-tabs__container").removeClass("masterstudy-single-course-tabs__container_active").filter((function(){return e(this).data("id")===s})).addClass("masterstudy-single-course-tabs__container_active");e("html, body").animate({scrollTop:e(t).offset().top-70},1e3,(function(){a=!0}))})),e(window).on("scroll",(function(){if(a){var s=e(window).scrollTop(),t=!1;e(".masterstudy-single-course-tabs__container").each((function(){var i=e(this),a=i.offset().top,r=a+i.height();if(s>=a-70&&s<r-70){var n=i.data("id");t=!0,e(".masterstudy-single-course-tabs__item").each((function(){var s=e(this);s.data("id")===n&&(s.siblings().removeClass("masterstudy-single-course-tabs__item_active"),s.addClass("masterstudy-single-course-tabs__item_active"))}))}})),t||e(".masterstudy-single-course-tabs__item").removeClass("masterstudy-single-course-tabs__item_active")}}))}e(".masterstudy-single-course-tabs_style-sidebar").length&&window.matchMedia("(max-width: 1023.98px)").matches&&(e(".masterstudy-single-course-tabs").removeClass("masterstudy-single-course-tabs_style-sidebar"),e(".masterstudy-single-course-tabs__content").removeClass("masterstudy-single-course-tabs_style-sidebar"),e(".masterstudy-single-course-tabs").children().first().addClass("masterstudy-single-course-tabs__item_active"),e(".masterstudy-single-course-tabs__content").children().first().addClass("masterstudy-single-course-tabs__container_active")),e("body").on("click",".masterstudy-single-course-wishlist",(function(){var s=e(this).attr("data-id");e("body").hasClass("logged-in")&&e.ajax({url:stm_lms_ajaxurl,dataType:"json",context:this,data:{action:"stm_lms_wishlist",nonce:stm_lms_nonces.stm_lms_wishlist,post_id:s},complete:function(s){var t=s.responseJSON;e(this).find(".masterstudy-single-course-wishlist__title").toggleClass("masterstudy-single-course-wishlist_added"),wishlist_data.without_title||e(this).find(".masterstudy-single-course-wishlist__title").text(t.text)}})}))})),e(".masterstudy-single-course-excerpt__more").click((function(){e(this).siblings(".masterstudy-single-course-excerpt__hidden").toggle(),e(this).siblings(".masterstudy-single-course-excerpt__continue").toggle(),e(this).text(e(this).text().trim()===excerpt_data.more_title?excerpt_data.less_title:excerpt_data.more_title)})),setTimeout((function(){e(".masterstudy-single-course-share-button-modal").removeAttr("style")}),1e3),e(".masterstudy-single-course-share-button__title").click((function(){e(this).parent().next().addClass("masterstudy-single-course-share-button-modal_open"),e("body").addClass("masterstudy-single-course-share-button-body-hidden")})),e(".masterstudy-single-course-share-button-modal").click((function(s){s.target===this&&(e(".masterstudy-single-course-share-button-modal").removeClass("masterstudy-single-course-share-button-modal_open"),e("body").removeClass("masterstudy-single-course-share-button-body-hidden"))})),e(".masterstudy-single-course-share-button-modal__close").on("click",(function(){e(".masterstudy-single-course-share-button-modal").removeClass("masterstudy-single-course-share-button-modal_open"),e("body").removeClass("masterstudy-single-course-share-button-body-hidden")})),e(".masterstudy-single-course-share-button-modal__link_copy").click((function(s){s.preventDefault();var t=document.createElement("input"),i=e(this);t.style.position="absolute",t.style.left="-9999px",t.value=e(this).data("url"),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t);var a=i.text();i.text(share_data.copy_text),setTimeout((function(){i.text(a)}),2e3)}))}(jQuery);