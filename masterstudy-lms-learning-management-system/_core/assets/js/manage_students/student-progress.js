"use strict";!function(t){t(document).ready((function(){var e=t(".masterstudy-student-progress"),s=new URLSearchParams(window.location.search),r=s.get("course_id"),n=s.get("student_id");function a(t){t=t||0,e.find(".masterstudy-progress__bar-filled").css({width:"".concat(t,"%")}),e.find(".masterstudy-progress__percent").text(t)}function d(e){var s=e?t(this).parent().next():t(this).parent().parent().next(),r=e?"masterstudy-student-progress-list__wrapper_opened":"masterstudy-student-progress-list__container-wrapper_opened";s.is(":visible")?(s.slideUp(300),t(this).parent().parent().removeClass(r)):(s.slideDown(300),t(this).parent().parent().addClass(r))}t.each(t(".masterstudy-student-progress-list__meta-checkbox"),(function(e,s){"assignment"===t(s).attr("data-type")&&t(s).prop("checked")&&t(s).attr("disabled",!0),t(s).on("change",(function(e){e.preventDefault();var d=new URLSearchParams({completed:t(s).is(":checked"),item_id:t(s).attr("data-item-id")}).toString(),i="".concat(ms_lms_resturl,"/student/progress/").concat(r,"/").concat(n,"/?").concat(d);"assignment"===t(s).attr("data-type")&&t(s).attr("disabled",!0),"quiz"===t(s).attr("data-type")&&t.each(t(".masterstudy-student-progress__quiz"),(function(e,s){0<e&&t(s).css({display:"none"})})),fetch(i,{method:"PUT",headers:{"X-WP-Nonce":ms_lms_nonce,"Content-Type":"application/json"}}).then((function(t){if(t.ok)return t.json()})).then((function(e){!function(e){var s=t(e).parents(".masterstudy-student-progress-list__item");if(t(e).prop("checked")){var r=s.find(".masterstudy-student-progress-list__item-content_result");s.find(".masterstudy-student-progress-list__item-content").addClass("masterstudy-student-progress-list__item-content_completed"),s.find(".masterstudy-student-progress-list__item-no-answer").removeClass("masterstudy-student-progress-list__item_hidden"),s.find(".masterstudy-student-progress-list__item-quiz").addClass("masterstudy-student-progress-list__item_hidden"),r.removeClass("masterstudy-student-progress-list__item_hidden"),r.find(".masterstudy-course-player-quiz__result-progress").text("100%"),r.find(".masterstudy-course-player-quiz__result-answers strong:first").text("0")}else s.find(".masterstudy-student-progress-list__item-content").removeClass("masterstudy-student-progress-list__item-content_completed")}(s),a(e.progress_percent),("assignment"===t(s).attr("data-type")||"quiz"===t(s).attr("data-type")&&t(s).prop("checked"))&&window.location.reload()})).catch((function(t){throw t}))}))})),t(".masterstudy-student-progress-list__toggler").click((function(t){t.preventDefault(),d.call(this,!0)})),t(".masterstudy-student-progress-list__content-toggler").click((function(t){t.preventDefault(),d.call(this,!1)})),t(".masterstudy-student-progress-list__link_disabled").click((function(t){t.preventDefault()})),t(".masterstudy-hint").hover((function(){t(this).closest(".masterstudy-student-progress-list__materials").css("overflow","visible")}),(function(){t(this).closest(".masterstudy-student-progress-list__materials").css("overflow","hidden")}));var i=t("[data-id='masterstudy-manage-students-reset-progress']");function o(t){t.preventDefault(),i.removeClass("masterstudy-alert_open")}i.css("display","none"),t("body").on("click",'[data-id="masterstudy-progress-reset"]',(function(t){t.preventDefault(),i.css("display","flex"),i.addClass("masterstudy-alert_open")})),i.find("[data-id='submit']").click((function(e){e.preventDefault(),fetch("".concat(ms_lms_resturl,"/student/progress/").concat(r,"/").concat(n),{method:"DELETE",headers:{"X-WP-Nonce":ms_lms_nonce,"Content-Type":"application/json"}}).then((function(t){if(t.ok)return t.json()})).then((function(e){e.progress_percent&&(t.each(t(".masterstudy-student-progress-list__meta-checkbox"),(function(e,s){!function(e){var s=t(e).parents(".masterstudy-student-progress-list__item");t(e).prop("checked",!1),t(e).attr("disabled",!1),s.find(".masterstudy-student-progress-list__item-content").removeClass("masterstudy-student-progress-list__item-content_completed")}(s)})),a(e.progress_percent),i.removeClass("masterstudy-alert_open"))})).catch((function(t){throw i.removeClass("masterstudy-alert_open"),t}))})),i.find("[data-id='cancel']").click(o),i.find(".masterstudy-alert__header-close").click(o)}))}(jQuery);