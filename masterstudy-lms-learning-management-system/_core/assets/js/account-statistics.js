"use strict";function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}jQuery(document).ready((function(){Vue.component("date-picker",DatePicker.default),new Vue({el:"#stm-account-statistics",data:{currency_symbol:null,paypal_email:null,paypal_email_result:null,paypal_email_loader:!1,author_id:0,courses:1,selected_course:0,loading:!1,load_more_loading:!1,show_load_more:!1,limit:10,height:400,offset:0,total:0,total_price:0,date_range:null,date_from:null,date_to:null,order_items:[],labels_earnings:null,datasets_earnings:null,labels_sales:[],datasets_sales:[{data:[],backgroundColor:[]}]},created:function(){var t=this;if("undefined"!=typeof account_statistics_data){if(void 0!==account_statistics_data.currency_symbol&&(this.currency_symbol=account_statistics_data.currency_symbol),void 0!==account_statistics_data.author_id&&(this.author_id=account_statistics_data.author_id),void 0!==account_statistics_data.paypal_email&&(this.paypal_email=account_statistics_data.paypal_email),void 0!==account_statistics_data.labels_earnings&&(this.labels_earnings=account_statistics_data.labels_earnings),void 0!==account_statistics_data.datasets_earnings){var a=[];if("object"===_typeof(account_statistics_data.datasets_earnings))for(var e in account_statistics_data.datasets_earnings)account_statistics_data.datasets_earnings.hasOwnProperty(e)&&a.push(account_statistics_data.datasets_earnings[e]);else a=account_statistics_data.datasets_earnings;this.datasets_earnings=a,a.forEach((function(t){var a=Object.keys(t.data).map((function(a){return[t.data[a]]}));t.data=a}))}void 0!==account_statistics_data.sales_statisticas&&account_statistics_data.sales_statisticas.forEach((function(a){t.labels_sales.push(a.title),t.datasets_sales[0].data.push(a.order_item_count),t.datasets_sales[0].backgroundColor.push(a.backgroundColor)}))}},mounted:function(){this.get_course(),this.get_order_item()},methods:{save_email:function(){var t=this;if(t.paypal_email_loader)return!0;t.paypal_email_loader=!0,t.paypal_email_result=null;var a={"X-WP-Nonce":stm_lms_vars.wp_rest_nonce},e=new FormData;e.append("paypal_email",t.paypal_email),this.$http.post("stm-lms-payout/paypal-email",e,{headers:a}).then((function(a){t.paypal_email_loader=!1,t.paypal_email_result=a.body}))},get_course:function(){var t=this;this.$http.get("stm-lms-user/course-list",{params:{author_id:t.author_id}}).then((function(a){t.courses=[{id:0,title:"All"}],t.courses=t.courses.concat(a.body)}))},get_order_item:function(t){var a=this;a.loading=!0,a.load_more_loading=!0;var e=new FormData,s={"X-WP-Nonce":stm_lms_vars.wp_rest_nonce};e.append("limit",a.limit),e.append("offset",a.offset),e.append("author_id",account_statistics_data.author_id),e.append("nonce",stm_lms_vars.wp_rest_nonce),a.date_from&&a.date_to&&(e.append("date_from",a.date_from),e.append("date_to",a.date_to)),a.selected_course&&e.append("course_id",a.selected_course),this.$http.post("stm-lms/order/items",e,{headers:s}).then((function(e){a.load_more_loading=!1,void 0!==e.body.items&&(a.order_items=t?a.order_items.concat(e.body.items):e.body.items),void 0!==e.body.total&&(a.total=e.body.total),void 0!==e.body.total_price&&(a.total_price=e.body.total_price),a.total<=a.order_items.length?a.show_load_more=!1:a.show_load_more=!0}))},load_more:function(){this.load_more_loading||(this.load_more_loading=!0,this.offset+=this.limit,this.get_order_item(!0))},formatPrice:function(t){return(t/1).toFixed(2).replace(".",",").toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},dateChanged:function(t){this.date_from=moment(t[0]).format("YYYY-MM-DD"),this.date_to=moment(t[1]).format("YYYY-MM-DD"),this.offset=0,this.get_order_item(!1)}},watch:{date_range:function(t){t||(this.date_range=null,this.date_from=null,this.offset=0,this.get_order_item(!1))},selected_course:function(t){this.offset=0,this.get_order_item(!1)}}})})),Vue.component("line-chart",{extends:VueChartJs.Line,mounted:function(){var t,a;this.renderChart({labels:this.labels,datasets:this.datasets},{title:{display:!0,text:null!==(t=null===(a=masterstudy_lms_statistics_texts)||void 0===a?void 0:a.earnings_text)&&void 0!==t?t:"Earnings",fontSize:22},responsive:!0,maintainAspectRatio:!1,legend:{position:"bottom",labels:{boxWidth:10,usePointStyle:!0,padding:20}},scales:{yAxes:[{type:"linear",ticks:{userCallback:function(t){return"$ "+t.toString()}}}]}})},props:{labels:{default:["January","February","March","April","May","June"]},datasets:{default:[]}}}),Vue.component("line-pie",{extends:VueChartJs.Pie,mounted:function(){var t,a;this.renderChart({labels:this.labels,datasets:this.datasets},{title:{display:!0,text:null!==(t=null===(a=masterstudy_lms_statistics_texts)||void 0===a?void 0:a.sales_text)&&void 0!==t?t:"Sales",fontSize:22},responsive:!0,maintainAspectRatio:!1,legend:{position:"bottom",labels:{boxWidth:10,usePointStyle:!0,padding:20}}})},props:{labels:{default:["Data One1","Data One2","Data One3","Data One4"]},datasets:{default:[{data:[45,32,4,0],backgroundColor:["rgba(248, 121, 113, 0.42)","rgba(44, 117, 228, 0.44)","rgba(47, 190, 64, 0.52)","rgba(47, 100, 100, 0.52)"]}]}}});